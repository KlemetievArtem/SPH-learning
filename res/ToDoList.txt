Разобраться с алгоритмом. Почему же, блин, не работает?(

мб чтот связано с тем, какие именно частицы я включаю в алгоритм:
мб граничные частиы и не надо (в настоящей постановке задаче точно не правильно, тюкю реальные частица в 2D-измерении, а граничные частицы в 3D-измерении);
мб виртуальные частицы не надо (наврятли);

Все-таки чтот надо сделать с границами:
прошерстить литературу по ГСЧ еще раз и п-нормальному все систематизировать;
пока варианты следующие: отталкивающие силы, увеличение плотности у граничных частиц( чтобы от них охотнее отталкивались), поправочный коэффициент к Частичному приближению (но тогда вообще все аппроксимации меняются);


В целом сосдать более удобную систему для опробации различных моделей.


Сделать возможным иницилизацию реальных частиц в сконструированной, не обязатьельно прямоугольной, расчетной области. 


Оптимизация:
сделать один цикл пробегания по всем парам, а не бегать в каждом методе;


и много, много, много ...